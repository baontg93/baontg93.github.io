window.__require=function t(e,i,n){function o(c,a){if(!i[c]){if(!e[c]){var r=c.split("/");if(r=r[r.length-1],!e[r]){var h="function"==typeof __require&&__require;if(!a&&h)return h(r,!0);if(s)return s(r,!0);throw new Error("Cannot find module '"+c+"'")}c=r}var l=i[c]={exports:{}};e[c][0].call(l.exports,function(t){return o(e[c][1][t]||t)},l,l.exports,t,e,i,n)}return i[c].exports}for(var s="function"==typeof __require&&__require,c=0;c<n.length;c++)o(n[c]);return o}({ButtonBack:[function(t,e){"use strict";cc._RF.push(e,"69e93tYiadIeZcqNiZ8qQ3j","ButtonBack"),cc.Class({extends:cc.Component,onLoad:function(){this.node.on("click",this.handleButtonClick,this)},handleButtonClick:function(){EventManager.publish("backToList",this)}}),cc._RF.pop()},{}],ButtonMoreCity:[function(t,e){"use strict";cc._RF.push(e,"f5a9dC3Dm1Lj6JXzmjtl7J/","ButtonMoreCity"),cc.Class({extends:cc.Component,onLoad:function(){EventManager.register(this),this.node.active=!0,this.node.on("click",this.handleButtonClick,this)},onEvent:function(t){switch(t){case"resetListCity":this.node.active=!0}},handleButtonClick:function(){this.node.active=!1,EventManager.publish("loadMoreCity",this)}}),cc._RF.pop()},{}],ButtonResetList:[function(t,e){"use strict";cc._RF.push(e,"2c23dyS90hO8IxLPOqQ3VhO","ButtonResetList"),cc.Class({extends:cc.Component,onLoad:function(){EventManager.register(this),this.node.active=!1,this.node.on("click",this.handleButtonClick,this)},onEvent:function(t){switch(t){case"loadMoreCity":this.node.active=!0}},handleButtonClick:function(){this.node.active=!1,EventManager.publish("resetListCity",this)}}),cc._RF.pop()},{}],City:[function(t,e){"use strict";cc._RF.push(e,"e582dmUoNRAOqlsl542bTL/","City"),cc.Class({extends:t("DetailValue"),setData:function(t){this.node.getComponent(cc.Label).string=t.name},reset:function(){this.node.getComponent(cc.Label).string=""}}),cc._RF.pop()},{DetailValue:"DetailValue"}],DetailValue:[function(t,e){"use strict";cc._RF.push(e,"c5b02GFDl1HUKSf8gC5E2lF","DetailValue"),cc.Class({extends:cc.Component,onLoad:function(){EventManager.register(this)},onEvent:function(t,e){switch(t){case"weatherDataCompleted":this.reset(),this.setData(e);break;case"backToList":case"selectCity":this.reset()}},setData:function(){},reset:function(){}}),cc._RF.pop()},{}],FeelLike:[function(t,e){"use strict";cc._RF.push(e,"cc87e/SBqZHbaxFAZotwmjy","FeelLike"),cc.Class({extends:t("DetailValue"),setData:function(t){this.node.getComponent(cc.Label).string=this.kelvinToCelcius(t.main.feels_like)+"\u2103"},kelvinToCelcius:function(t){return(t-273.15).toPrecision(2)},reset:function(){this.node.getComponent(cc.Label).string=""}}),cc._RF.pop()},{DetailValue:"DetailValue"}],Humidity:[function(t,e){"use strict";cc._RF.push(e,"918a4gsdeRHwKxK5rn9+eu9","Humidity"),cc.Class({extends:t("DetailValue"),setData:function(t){this.node.getComponent(cc.Label).string=t.main.humidity},reset:function(){this.node.getComponent(cc.Label).string=""}}),cc._RF.pop()},{DetailValue:"DetailValue"}],Loading:[function(t,e){"use strict";cc._RF.push(e,"cfda67xQpFGQadLPxXjkPOC","Loading"),cc.Class({extends:cc.Component,onLoad:function(){EventManager.register(this),this.node.active=!1},onEvent:function(t){switch(t){case"loadingData":this.node.active=!0;break;case"dataLoadCompleted":case"weatherDataCompleted":this.node.active=!1}}}),cc._RF.pop()},{}],RemoveWidget:[function(t,e){"use strict";cc._RF.push(e,"6e0b7JJe3dI64GZHoFRmfGX","RemoveWidget"),cc.Class({extends:cc.Component,onLoad:function(){if(0==cc.sys.isMobile){var t=this.node.getComponent(cc.Widget);t.isAlignLeft=t.isAlignRight=!1,this.node.width=cc.view._designResolutionSize.width}}}),cc._RF.pop()},{}],RootDetail:[function(t,e){"use strict";cc._RF.push(e,"430b9Q5WHlFBogP0qJKZfvG","RootDetail"),cc.Class({extends:cc.Component,onLoad:function(){EventManager.register(this),this.node.active=!1},onEvent:function(t,e){switch(t){case"selectCity":this.node.active=!0,this.loadData(e);break;case"backToList":this.node.active=!1}},loadData:function(t){var e=new XMLHttpRequest;e.open("GET","https://api.openweathermap.org/data/2.5/weather?q="+t+"&appid=fc0264dd5bfabfb4ba0a44d060e99afe"),e.send(""),EventManager.publish("loadingData"),e.onreadystatechange=function(){if(4!=e.readyState||200!=e.status);else{var t=JSON.parse(e.responseText);EventManager.publish("weatherDataCompleted",t)}}}}),cc._RF.pop()},{}],RootList:[function(t,e){"use strict";cc._RF.push(e,"61850FUBLZORJhjawhMsA97","RootList");var i=t("SmartScrollView");cc.Class({extends:cc.Component,properties:{listCity:cc.JsonAsset,listCityFull:cc.JsonAsset,smartScrollView:i},onLoad:function(){EventManager.register(this),this.node.active=!0,this.city=null},start:function(){this.showListCities(this.listCity.json)},onEvent:function(t){switch(t){case"selectCity":this.node.active=!1;break;case"backToList":this.node.active=!0;break;case"resetListCity":this.showListCities(this.listCity.json);break;case"loadMoreCity":this.showListCities(this.listCityFull.json)}},showListCities:function(t){t=t.slice(),null!=this.city?(t.unshift(this.city),this.smartScrollView.initScrollView(t)):this.getCity(this.showListCities.bind(this,t))},getCity:function(t){var e=this;EventManager.publish("loadingData"),navigator.geolocation.getCurrentPosition(function(i){EventManager.publish("dataLoadCompleted");var n=i.coords,o=n.latitude.toString(),s=n.longitude.toString(),c=new XMLHttpRequest;c.open("GET","https://us1.locationiq.com/v1/reverse.php?key=pk.37c4242d7c0d0e5d05916c37bebe8bcd&lat="+o+"&lon="+s+"&format=json",!0),c.send(),EventManager.publish("loadingData"),c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){var i;EventManager.publish("dataLoadCompleted");var n=JSON.parse(c.responseText);return e.city=null!=(i=n.address.city)?i:n.address.state,void(t&&t())}}},function(t){EventManager.publish("dataLoadCompleted"),console.warn("ERROR("+t.code+"): "+t.message)})}}),cc._RF.pop()},{SmartScrollView:"SmartScrollView"}],SelectCityItem:[function(t,e){"use strict";cc._RF.push(e,"08329T6GgFOsrCqW7csPTiH","SelectCityItem"),cc.Class({extends:cc.Component,properties:{labelCity:cc.Label},ctor:function(){this.city=""},onLoad:function(){this.node.on("click",this.handleButtonClicked,this)},setCity:function(t){this.city=t,this.labelCity.string=t},handleButtonClicked:function(){EventManager.publish("selectCity",this.city)}}),cc._RF.pop()},{}],SmartScrollView:[function(t,e){"use strict";cc._RF.push(e,"adcdbii8wtFI6AEbziPIRQp","SmartScrollView");var i=t("SelectCityItem");cc.Node.prototype.GetWorldPosition=function(){var t=this.position;return null!==this.parent?this.parent.convertToWorldSpaceAR(t):t},cc.Class({extends:cc.ScrollView,properties:{view:cc.Node,pool:cc.Node,prefab:cc.Prefab,spacing:0,excessObjectQuantity:4,buttonMoveToTop:cc.Node},onLoad:function(){var t=this;t.itemHeight=t.prefab.data.height,t.maxQuantity=Math.round(t.view.height/(t.itemHeight+t.spacing)),t.topItem=null,t.bottomItem=null,t.topCoordinate=0,t.bottomCoordinate=0,t.topIndex=0,t.bottomIndex=0,t.topSiblingIndex=0,t.bottomSiblingIndex=0,t.currentContentY=t.content.y,t.listItemInContainer=[],t.listItemInPool=[],t.arrCities=[],t.arrPositions=[],t.arrCurrentItem=[],t.buttonMoveToTop&&(t.buttonMoveToTop.active=!1,t.buttonMoveToTop.on("click",function(){t.stopAutoScroll(),t.scrollToTop(1)}))},clear:function(){for(this.stopAutoScroll(),this.scrollToTop();this.listItemInContainer.length>0;){var t=this.listItemInContainer.pop();this.despawn(t)}this.arrCities=[],this.listItemInContainer=[],this.arrCurrentItem=[],this.arrPositions=[]},initScrollView:function(t){this.maxQuantity=Math.round(this.view.height/(this.itemHeight+this.spacing)),this.clear(),this.content.height=t.length*(this.itemHeight+this.spacing);for(var e=this.maxQuantity+this.excessObjectQuantity,n=-this.itemHeight/2-this.spacing,o=0;o<t.length;o++){var s=t[o];if(this.arrCities.push(s),this.arrPositions.push(new cc.Vec2(0,n-o*(this.itemHeight+this.spacing))),o<e){var c=this.getItem();c.position=this.arrPositions[o];var a=c.getComponent(i);a.setCity(s),this.arrCurrentItem.push(a),0==o?(this.topItem=c,this.topIndex=o,this.topSiblingIndex=o,this.topCoordinate=c.GetWorldPosition().y+this.itemHeight*this.excessObjectQuantity/2):o==this.maxQuantity-1?(this.bottomItem=c,this.bottomCoordinate=c.GetWorldPosition().y-this.itemHeight*this.excessObjectQuantity/2):o==e-1&&(this.bottomIndex=o,this.bottomSiblingIndex=o)}}this.buttonMoveToTop.active=t.length>this.maxQuantity+this.excessObjectQuantity},getItem:function(){var t=null;return(t=this.listItemInPool.length>0?this.listItemInPool.pop():cc.instantiate(this.prefab)).active=!0,t.parent=this.content,this.listItemInContainer.push(t),t},despawn:function(t){t.active=!1,t.parent=this.pool,this.listItemInPool.push(t)},setContentPosition:function(t){this.updatePosition(t),this._super(t)},updatePosition:function(t){if(null!=this.topItem&&null!=this.bottomItem&&0!=this.itemHeight&&this.arrCurrentItem&&Math.abs(this.currentContentY-t.y)>=this.itemHeight){if(t.y>this.currentContentY)for(;this.topItem.GetWorldPosition().y>this.topCoordinate&&this.bottomIndex!=this.arrCities.length-1;)this.topIndex++,this.bottomIndex++,this.topItem.position=this.arrPositions[this.bottomIndex],this.topItem.setSiblingIndex(this.bottomSiblingIndex),this.topItem.getComponent(i).setCity(this.arrCities[this.bottomIndex]),this.topItem=this.content.children[this.topSiblingIndex],this.bottomItem=this.content.children[this.bottomSiblingIndex];if(t.y<this.currentContentY)for(;this.bottomItem.GetWorldPosition().y<this.bottomCoordinate&&0!=this.topIndex;)this.topIndex--,this.bottomIndex--,this.bottomItem.position=this.arrPositions[this.topIndex],this.bottomItem.setSiblingIndex(this.topSiblingIndex),this.bottomItem.getComponent(i).setCity(this.arrCities[this.topIndex]),this.topItem=this.content.children[this.topSiblingIndex],this.bottomItem=this.content.children[this.bottomSiblingIndex];this.currentContentY=t.y}}}),cc._RF.pop()},{SelectCityItem:"SelectCityItem"}],Temperature:[function(t,e){"use strict";cc._RF.push(e,"566e1FTJwROUrHa8mtzcXin","Temperature"),cc.Class({extends:t("DetailValue"),setData:function(t){this.node.getComponent(cc.Label).string=this.kelvinToCelcius(t.main.temp)+"\u2103"},kelvinToCelcius:function(t){return(t-273.15).toPrecision(2)},reset:function(){this.node.getComponent(cc.Label).string=""}}),cc._RF.pop()},{DetailValue:"DetailValue"}],WeatherIcon:[function(t,e){"use strict";cc._RF.push(e,"eba94fMZFpFkIIO0oaeSHTF","WeatherIcon"),cc.Class({extends:t("DetailValue"),setData:function(t){var e=this.node.getComponent(cc.Sprite);this.loadImage("http://openweathermap.org/img/wn/"+t.weather[0].icon+"@2x.png",e,e.node)},loadImage:function(t,e,i){cc.assetManager.loadRemote(t,function(t,n){if(t)cc.error(t);else{var o={x:0,y:0,width:n.width,height:n.height},s=new cc.SpriteFrame(n,o,!1,null,o);e.spriteFrame=s;var c=Math.min(i.width/n.width,i.height/n.height);e.node.width=n.width*c,e.node.height=n.height*c}})},reset:function(){this.node.getComponent(cc.Sprite).spriteFrame=null}}),cc._RF.pop()},{DetailValue:"DetailValue"}],Wind:[function(t,e){"use strict";cc._RF.push(e,"84416JayV1Dlb32S73FUqBm","Wind"),cc.Class({extends:t("DetailValue"),setData:function(t){this.node.getComponent(cc.Label).string=t.wind.speed},reset:function(){this.node.getComponent(cc.Label).string=""}}),cc._RF.pop()},{DetailValue:"DetailValue"}]},{},["ButtonBack","ButtonMoreCity","ButtonResetList","City","DetailValue","FeelLike","Humidity","Temperature","WeatherIcon","Wind","Loading","RemoveWidget","RootDetail","RootList","SelectCityItem","SmartScrollView"]);